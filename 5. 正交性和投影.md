P95-131   9.12 - 13

### 1. 范数和向量

欧几里得范数：

![[2e45e016-eabc-43ff-867f-725ec224c867.png]]

欧几里得范数特点：

- **非负性** ： ||v|| >= 0
- **正定性**：||v|| = 0 仅当 v = 0
- **齐次性**：||cv|| = |c| ||v||

**单位向量**：

- 范数为 1 的向量
- 所有单位向量的集合也被称为**单位球面**
- 称标准基 $e_j$ 为**标准单位向量**  --- $||e_j|| = 1$
- **非零向量标准化**：$w = \frac{v}{||v||}, ||w|| = 1$
- 点 v 和 w 之间线段长度：$||v - w||$

### 2. 角度

- $v,w \in R^2$， $v$ 和 $w$ 之间的夹角 $\theta$ 满足 $cos\theta = \frac{v_1w_1+v_2w_2}{||v|| \cdot ||w||}$
- 同理，在 $R^3$ 中定义一个 $\theta$，$cos\theta = \frac{v_1w_1+v_2w_2 + v_3w_3}{||v|| \cdot ||w||}$
- **内积**：$<v,w> = v^Tw$
	- 对称性：$<v,w> = <w,v>$
	- 分配律：$<u,v+w> = <u,v> + <u,w>$
	- 齐次性: $<cv,w> = c<v,w>$
	- 正定性：$<v,v> \geq 0$  且 $<v,v>=0$，那么 $v= 0$
- **正交**：$<v,w> = 0$
	- $\theta = cos^{-1}(\frac{<v,w>}{||v|| \cdot ||w||})$
	- v ⊥ w
	- 零向量和**任何向量**正交

### 3. 标量积

**内积空间（标量积空间）**：$<\cdot,\cdot> : V \times V \to \mathbb{R}$

**范数的内积定义**：$||v|| = \sqrt{<v,v>}$

**勾股定理**：对于正交向量 $v,w$，$||v+w||^2 = ||v||^2 + ||w||^2$

证明：

- 根据范数的内积定义：$||v+w||^2 = <v+w,v+w>$
- 根据内积的分配律：$<v+w,v+w> = <v+w,v> + <v+w,w> = <v,v> + 2<v,w> + <w,w>$
- 根据正交向量定义，$<v,w> = 0$
- 所以，$<v+w,v+w> = <v,v> + <w,w>$
- 再根据范数的内积定义：$<v,v> = ||v||^2,<w,w> = ||w||^2$
- 所以，$||v+w||^2 = ||v||^2 + ||w||^2$

**柯西-施瓦茨不等式**：$<v,w> \leq ||v|| \cdot ||w||$

**三角不等式**：$||u+v|| \leq ||u|| + ||v||$  --- 可以通过基本性质和柯西-施瓦茨不等式来证明

**距离函数**：$d(u,w) \leq d(u,v) + d(v,w)$

- $d(u,v) = d(v,u)$
- $d(u,v) = 0$ 当且仅当  $u = v$

**!!! 过引入标量积，我们可以将抽象的向量空间赋予具体的几何意义 !!!**

### 4. 正交空间

**定义**：设 W 是标量积空间 V 的一个子空间。如果对所有 w ∈ W 都有 ⟨v, w⟩ = 0，我们称 v ∈ V 与 W 正交，记作 v ⊥ W。

**定义**：设 W 是 V 的子空间，那么我们称集合  $W^⊥ = {v ∈ V : v ⊥ W}$  为（正交）补空间或 W 的（正交）补。

**定理 5.4.3.** 设 W 是 V 的子空间。那么：  
	
- $W^⊥$ 是 V 的子空间  
- $W ∩ W^⊥$ = {0}

**W + U = {w + u : w ∈ W, u ∈ U}**     ---- ?

**定理 5.4.5.** 设 W 是 V 的子空间。那么 $W + W^⊥ = V$

如果空间 W 和 U 相互正交，即 W ⊥ U，那么我们不写 W + U，而是写 W ⊕ U

**定理 5.4.7.** 设 W 是向量空间 V 的子空间，𝒲 = {w₁, ..., wₖ} 是 W 的一组基。那么 v ⊥ W 当且仅当 v ⊥ wᵢ 对所有 i = 1, ..., k 成立。

- 想象你有一个房间（子空间 W），这个房间由几根柱子（基向量）支撑。
- 例如 V 是二维平面空间，W是X和 Y轴（W是XY平面），这个W（XY平面有一组正交基），任意一个W中的向量v，要判定是否正交于W，**需要判定v是否正交于W的所有的基**


**定理 5.4.8.** 对于任意矩阵 A ∈ ℝ^(m×n)，有  $col(A^T)^⊥ = ker(A) 且 col(A)^⊥ = ker(A^T)$  --- ???

- Col(A) 列空间
- Col(A^T) 行空间
- ker(A) 零空间（Ax = 0）
- ket(A^T) 左零空间（A^T y = 0)

### 5. 正交集合

**定义 **  
• 我们称 M = {v₁, ..., vₙ} ⊂ V 为**正交集合**，如果对所有 i ≠ j 都有 vᵢ ⊥ vⱼ。  
• 如果另外对所有 j 都有 ‖vⱼ‖ = 1，我们称 M 为**正交规范集合**（或标准正交集合）。

**例 5.5.2.** 标准基向量 e₁, ..., eₙ 是正交规范的。

**定理** 一个正交集合 M = {v₁, ..., vₙ} 如果不包含零向量（0 ∉ M），则线性无关。

**注释 5.5.5.** 反过来不成立。例如，向量 (1,1) 和 (1,0) 线性无关，但不正交，因为 ⟨(1,1),(1,0)⟩ = 1 ≠ 0。


正交集合 $==>$ 线性无关             
线性无关  $===X===>$  正交集合

也就是线性无关是正交集合的**必要条件**


**定义 5.5.6.** 向量空间 V 的**正交基**是 V 的一个基，同时也是正交集合。如果这个基还是正交规范的，我们称之为**正交规范基**（或标准正交基）。

在正交基下，要找向量 v 在某个基向量 vⱼ 方向上的坐标，只需要：

- $v = c_1v_1 + ... + c_nv_n$
- 其中，$c_j = \frac{<v,v_j>}{<v_j,v_j>}$
- 如果是正交规范基，$c_j = <v,v_j>$，因为在正交规范基下 $<v_j,v_j> = 1$
- 进而，$v = v_1e_1+...+v_ne_n$

### 6. 正交矩阵

我们也可以通过矩阵来刻画 ℝⁿ 中的正交规范集合:

**定理 5.6.1.**  
• 矩阵 U ∈ ℝᵐˣⁿ 的 **列正交规范**，当且仅当 $U^T U = I_n$  
• 矩阵 U ∈ ℝᵐˣⁿ 的 **行正交规范**，当且仅当 $UU^T = I_m$

![[c3e8148f-ee15-4cb8-bec3-f6b2e3661494.png]]

**定义 5.6.2.** 具有正交规范列和行的矩阵 U ∈ ℝⁿˣⁿ 称为**正交矩阵**。

- 仅有正交列/行的矩阵不会自动成为正交矩阵。列必须是正交规范的(!)。

**推论 5.6.4.** U ∈ ℝⁿˣⁿ 是正交的，当且仅当 U 可逆且 U⁻¹ = $U^T$

**定理 5.6.6.** 对于正交矩阵 U, W ∈ ℝⁿˣⁿ，有：  

- $U^T$ 和 U⁻¹ 是正交的。  
- 若 U, W ∈ ℝⁿˣⁿ 正交，则 UW 也正交。  
- det(U) = ±1。  
- ‖$Ux$‖ = ‖x‖ 对所有 x ∈ ℝⁿ。  
- ⟨Ux, Uy⟩ = ⟨x, y⟩ 对所有 x, y ∈ ℝⁿ。

**总结：正交矩阵 = 方阵 + 列正交规范 + 行正交规范**

关键发现：对于**方阵**，只要列正交规范，行就自动正交规范！

### 7. 正交投影

##### 7.1 **基本思想**：对于每个 v ∈ V 和子空间 W，我们能找到 v̂ ∈ W 和 z ∈ $W^⊥$，使得：

				v = v̂ + z

我们将 v 分解为子空间 W 中的向量和一个与 W 正交的向量。我们称向量 v̂ ∈ W 为 v 在 W 上的**投影**，z = v - v̂ 为**残差**

![[c3b17590-fd95-448e-83d4-db7bb651e1f7.png]]

- 我们有一个向量 y 和一个向量 u
- 我们想要将 y 投影到子空间（直线）L = span{u} 上
- 我们找到直线 L 上的点 ŷ，使得 z = y - ŷ 与 u 正交
- 此外，ŷ 是 L 中离 y 最近的点


**通俗理解**：**正交分解**

任何向量都可以唯一分解为：

- **投影部分**（v̂）：在子空间 W 内   ===>           v̂ ∈ W
- **垂直部分**（z）：与 W 垂直   ===>   z ∈ $W^⊥$
使得：

				v = v̂ + z

0 = $<u, y - \hat{y}> = <u,y> - <u,\hat{y}> = <u,y> - <u,cu> = <u,y> - c<u,u>$

- ŷ = cu （**投影是u的标量倍**）
- u 是投影方向

上面等式可以变换为：

- $c = \frac{<u,y>}{<u,u>}$
- 或者 $proj_Ly = \frac{<u,y>}{<u,u>} u$       **投影是u的标量倍**

##### 7.2 **投影定理**：设 W 是内积空间 V 的有限维子空间，

- 每个 v ∈ V 都可以唯一地表示为  $v=\hat{v}+z$，其中 $\hat{v} \in W$ 且 $z \in W^{\perp}$
- 对于 W 的每个正交基 W = {w₁, ..., wₖ}，都有

![[74557014-fa2d-45b4-a0c5-d22faf8ae185.png]]



![[b5aa77cd-0c17-4fb4-8075-c86719f314f9.png]]


投影是**线性运算**。在欧几里得空间中，它们也可以表示为**矩阵-向量乘法**



![[28293740-9183-4526-b4eb-cadd67ab964f.png]]

#### 7.3 **Gram-Schmidt正交化方法**

我们现在也可以证明，每个向量空间都有一个正交基。我们从任意基 {v₁,...,vₙ} 开始，将其转换为由正交向量组成的基 {u₁,...,uₙ}。


![[95dd46de-ca84-4a78-8b59-bce981541391.png]]

**定理 5.7.4.** 设 S = {v₁,...,vₙ} ⊆ V。那么对于每个 k = 1,...,n，通过Gram-Schmidt方法生成的集合 {u₁,...,uₖ} 是正交的。如果 S 也是线性无关的，则还有  span{v₁,...,vₖ} = span{u₁,...,uₖ}.

**推论 5.7.5.** 如果 {v₁,...,vₙ} 是 V 的基，那么通过Gram-Schmidt方法生成的集合 {u₁,...,uₖ} 是 V 的正交基。

**定理 5.7.7.** 每个有限维内积空间都有一个正交基。


**注释 5.7.6.** 同样可以生成一个标准正交基 {w₁,...,wₙ}，其中将正交基的向量标准化：wⱼ = uⱼ/||uⱼ||。


#### 7.4 投影作为最佳逼近


最后，我们还想表述另一个直观的性质。从 v 到 W 的投影是 W 中最接近 v 的点。到向量 v 的距离因此被最小化

![[18e8ab43-3355-414b-bac9-9f3b3858c3c9.png]]
### 8. 最小二乘法

#### 8.1 问题引出

- 给定 n 组数据 $(y_1,x_1)...(y_n,x_n) \in \mathbb{R}^{p+1}$，这些数据对于 $\beta \in \mathbb{R}^p$ 满足：

					$y_i = x_i^T \beta$

**可见**，$x_n \in \mathbb{R}^p$，$x_i,i \in [1,n])$ **是个向量，不是一个值**

**例如：$y_1$ 代表房价， $x_i$ 代表 (地段，面积，楼层)，$\beta$ 代表回归系数，或者是影响因子**

例如： $(8,(2,3))$ 和 $(12,(4,6))$ --- $p = 2$

- $8 = (2,3) \cdot (\beta_1,\beta_2)^T$
- $12 = (4,6) \cdot (\beta_1,\beta_2)^T$

- 改写为线性方程组形式：$X\beta = y$

	即：$(x_1^T,x_2^T...,x_n^T)^T \cdot (\beta_1,...,\beta_n) = (y_1,...,y_n)$

上面方程组是理想情况，但现实中数据不会这么完美，所以要引入随机误差项：

现在我们可以通过求解线性方程组来找到合适的 **参数向量** β。这样的数据并不是特别现实，因此我们在统计学中允许存在 **随机误差** $\epsilon_i$，因此可以改写方程：

			$y_i = x_i^T\beta + \epsilon_i$

- 线性方程组 Xβ = y 通常没有解，因此，我们现在想要找到最能描述数据的参数 β：Xβ 和 y 之间的距离应该尽可能小。
- 我们通过两个向量差的**范数**来衡量它们的距离，这里就是 ||Xβ - y||。
- 这个距离越小，Xβ 就越好地近似观测值 y，**所以我们想要找到能使这个范数最小化的向量 β。**
- 一旦我们找到了这个 β，就可以通过 xᵢᵀβ 来**预测变量 yᵢ**。

**定义：最小二乘问题**：

给定一个线性方程组 $Ax = b$，其中 $A \in \mathbb{R}^{m×n}$ 且 $b \in \mathbb{R}^m$，我们想要找到一个向量 $\hat{x} \in \mathbb{R}^n$，使得 $||A\hat{x} - b||$ 最小。


注释：最小化距离 ||Ax - b|| 等价于最小化 ||Ax - b||² = ε₁² + ⋯ + εₙ²，其中
![[cab84acc-c2d0-4cda-9ce2-99c29f9dd840.png]]

#### 8.2 问题解决

- 首先观察 Ax，A的列空间 $Col(A)$ 中包含了 x 所有取值的结果
- 因此 我们需要寻找一个 $\hat{b} = A\hat{x} \in col(A)$         $\hat{x}$ -  **最佳**的参数（最小二乘的解）  $\hat{b}$ - **最佳**的近似
- $\hat{b}$ 和 $b$ 的**距离最小**
- **因此，$\hat{b}$ 在 $col(A)$ 的投影唯一**
- 所以，$\hat{b} = proj_{col(A)}b$  -- 向量 b 在 col(A) 空间的投影

**因此，求解方法：**

- 向量 b 在 col(A) 上进行投影得到：$\hat{b}$
- 线性方程组 $A\hat{x} = \hat{b}$ 求解（这个一定有解）
	- 因为 $\hat{b} \in col(A)$
	- 所以一定存在一个 $\hat{x}$ 使得 $A\hat{x} = \hat{b}$

问题改写 **避免投影计算**：

**定理**：最小二乘问题的所有解的集合等于正规方程（法方程）：$A^TA\hat{x} = A^Tb$ 的所有解的集合

所以：$x = (A^TA)^{-1}A^Tb$          **---- 重要！！！！！**

**以下命题等价：**

- A 的列线性无关
- $A^T A$ 可逆
- 最小二乘问题有唯一解 $\hat{x} = (A^T A)^{-1} A^T b$

**举例**：

![[cb57c2d9-db90-4dec-b4fd-502638822f1e.png]]

### 9. 其他内积空间

**不只有一种内积**：我们熟悉的点积（内积）不是唯一的选择

**解决方案**：使用加权内积，给不同分量赋予不同的权重，使得计算结果有物理意义。

#### 9.1 加权欧几里得内积

**定义 5.9.1.** 对于 $u, v, w ∈ R^n$ 且 $w_i > 0, 1 ≤ i ≤ n$，我们定义由 $w = (w₁,...,w_n)$ **加权的欧几里得标量积**为

				$⟨u, v⟩_w = w₁(u₁v₁) + ⋯ + w_n(u_nv_n)$

这种加权标量积在统计学中很有意义，例如当收集的数据 x₁,...,x_n 不能代表总体，而是每个 x_j 实际上出现了 w_j 次这样的情况。

当我们改变标量积时，空间的几何（长度、角度）会发生变化：

- 原来正交 ，加权后不正交（反之亦然）
- 原来长度，加权后长度变化

#### 9.2  矩阵空间

**定义 5.9.3.** 向量空间 $R^{m×n}$ 上的**标准标量积**定义为：$<A,B> = \Sigma_{i=1}^m\Sigma_{j=1}^na_{ij}b_{ij}$

一个方阵 $C \in R^{n \times n}$  的迹 ：$tr(C) = \Sigma_{i=1}^ncii$，$⟨A, B⟩ = tr(A^T B)$

由此，诱导的范数：$||A|| = \sqrt{<A,A>} = \sqrt{\Sigma_{i=1}^m\Sigma_{j=1}^n a_{ij}^2}$

- **迹（trace）**：方阵主对角线上所有元素的和


**有了矩阵的内积定义，投影定理可以继续应用：**

![[88911f00-8f79-4e4b-a991-84ae60832a6b.png]]

**投影定理：**
![[74557014-fa2d-45b4-a0c5-d22faf8ae185.png]]

#### 9.3  序列空间

我们现在转向无限维向量空间。我们用 ℓ₂ 表示所有**平方可和**序列的空间：

$ℓ_2 = \{x = (xᵢ)_{i=1}^{\infty} : Σ_{i=1}^n x²ᵢ < ∞\}$

当我们让维数 n 趋于无穷时，它经常作为 ℝⁿ 的极限情况出现。

**定义 5.9.6.** 向量空间 ℓ₂ 上的**标准标量积**定义为：

- $<x,y> = \Sigma_{i=1}^{\infty}x_iy_i$
- $||x|| = \sqrt{<x,x>} = \sqrt{\Sigma_{i=1}^{\infty}x_i^2}$


注意：$ℓ_2$ - 下标 2 的含义是 2- 范数，平方和

#### 9.4  函数空间

- 连续函数 $f:[a,b] \to \mathbb{R}$          -- 所有满足映射的函数
- 所有上述连续函数的子空间 $C([a,b])$
- $C([a,b]) = \{f:[a,b] \to \mathbb{R}\}$，其中 $f$ 是连续函数
- **标准标量积**：$<f,g> = \int_a^b f(x)g(x)dx$
- **范数**：$||f|| = \sqrt{\int_a^b f(x)^2dx}$

傅里叶积

#### 9.5 随机变量

**随机变量也可以看作向量空间中的向量！！**

**把随机变量当作"向量"，用线性代数的工具来研究概率统计。**

- 设 L² 是所有随机变量 $X: Ω → ℝ$ 且 $E(X²) < ∞$ 的集合，那么 L² 中的加法和乘法运算构成一个向量空间，
- **标量积**： ⟨X,Y⟩ = Cov(X,Y)
- **范数**：$||X|| = \sqrt{Var(X)} = \sigma$
- **正交**：随机变量不相关
- **柯西施瓦茨不等式**：$|Cov(X,Y)| \leq \sqrt{Var(X)Var(Y)}$
- **勾股定理**：$Var(X+Y) = Var(X) + Var(Y)$


**正交  => 内积为0 => 协方差为0**

**一个重要的应用是将条件期望值表述为投影**：

- 设 Y, X ∈ L² 是两个固定的随机变量
- W ⊂ L² 是所有可以写成 g(X) 形式（对于某个任意函数 g）的随机变量的子集
- 那么 W 是 L² 的子向量空间
- $Proj_W(Y) = E(Y | X)$

### 10. 正交对角化



